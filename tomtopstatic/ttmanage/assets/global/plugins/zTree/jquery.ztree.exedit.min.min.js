(function(aa){var M={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},T={edit:{enable:false,editNameSelectAll:false,showRemoveBtn:true,showRenameBtn:true,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:false,isCopy:true,isMove:true,prev:true,next:true,inner:true,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}},F=function(b){var a=P.getRoot(b),c=P.getRoots();a.curEditNode=null;a.curEditInput=null;a.curHoverNode=null;a.dragFlag=0;a.dragNodeShowBefore=[];a.dragMaskList=new Array();c.showHoverDom=true},ad=function(a){},S=function(c){var b=c.treeObj;var a=O.event;b.bind(a.RENAME,function(f,d,e,g){H.apply(c.callback.onRename,[f,d,e,g])});b.bind(a.DRAG,function(f,g,d,e){H.apply(c.callback.onDrag,[g,d,e])});b.bind(a.DRAGMOVE,function(f,g,d,e){H.apply(c.callback.onDragMove,[g,d,e])});b.bind(a.DROP,function(f,g,d,e,j,h,i){H.apply(c.callback.onDrop,[g,d,e,j,h,i])})},D=function(c){var b=c.treeObj;var a=O.event;b.unbind(a.RENAME);b.unbind(a.DRAG);b.unbind(a.DRAGMOVE);b.unbind(a.DROP)},R=function(f){var e=f.target,b=P.getSetting(f.data.treeId),d=f.relatedTarget,h="",l=null,k="",g="",a=null,i=null,j=null;if(H.eqs(f.type,"mouseover")){j=H.getMDom(b,e,[{tagName:"a",attrName:"treeNode"+O.id.A}]);if(j){h=H.getNodeMainDom(j).id;k="hoverOverNode"}}else{if(H.eqs(f.type,"mouseout")){j=H.getMDom(b,d,[{tagName:"a",attrName:"treeNode"+O.id.A}]);if(!j){h="remove";k="hoverOutNode"}}else{if(H.eqs(f.type,"mousedown")){j=H.getMDom(b,e,[{tagName:"a",attrName:"treeNode"+O.id.A}]);if(j){h=H.getNodeMainDom(j).id;k="mousedownNode"}}}}if(h.length>0){l=P.getNodeCache(b,h);switch(k){case"mousedownNode":a=U.onMousedownNode;break;case"hoverOverNode":a=U.onHoverOverNode;break;case"hoverOutNode":a=U.onHoverOutNode;break}}var c={stop:false,node:l,nodeEventType:k,nodeEventCallback:a,treeEventType:g,treeEventCallback:i};return c},G=function(e,a,b,g,c,f,d){if(!b){return}b.isHover=false;b.editNameFlag=false},V=function(a,b){b.cancelEditName=function(c){var d=P.getRoot(this.setting);if(!d.curEditNode){return}W.cancelCurEditNode(this.setting,c?c:null,true)};b.copyNode=function(e,f,g,c){if(!f){return null}if(e&&!e.isParent&&this.setting.data.keep.leaf&&g===O.move.TYPE_INNER){return null}var d=this,i=H.clone(f);if(!e){e=null;g=O.move.TYPE_INNER}if(g==O.move.TYPE_INNER){function h(){W.addNodes(d.setting,e,-1,[i],c)}if(H.canAsync(this.setting,e)){W.asyncNode(this.setting,e,c,h)}else{h()}}else{W.addNodes(this.setting,e.parentNode,-1,[i],c);W.moveNode(this.setting,e,i,g,false,c)}return i};b.editName=function(c){if(!c||!c.tId||c!==P.getNodeCache(this.setting,c.tId)){return}if(c.parentTId){W.expandCollapseParentNode(this.setting,c.getParentNode(),true)}W.editNode(this.setting,c)};b.moveNode=function(f,g,h,c){if(!g){return g}if(f&&!f.isParent&&this.setting.data.keep.leaf&&h===O.move.TYPE_INNER){return null}else{if(f&&((g.parentTId==f.tId&&h==O.move.TYPE_INNER)||X(g,this.setting).find("#"+f.tId).length>0)){return null}else{if(!f){f=null}}}var d=this;function e(){W.moveNode(d.setting,f,g,h,false,c)}if(H.canAsync(this.setting,f)&&h===O.move.TYPE_INNER){W.asyncNode(this.setting,f,c,e)}else{e()}return g};b.setEditable=function(c){this.setting.edit.enable=c;return this.refresh()}},Q={setSonNodeLevel:function(c,f,a){if(!a){return}var b=c.data.key.children;a.level=(f)?f.level+1:0;if(!a[b]){return}for(var d=0,e=a[b].length;d<e;d++){if(a[b][d]){P.setSonNodeLevel(c,a,a[b][d])}}}},Z={},U={onHoverOverNode:function(a,b){var c=P.getSetting(a.data.treeId),d=P.getRoot(c);if(d.curHoverNode!=b){U.onHoverOutNode(a)}d.curHoverNode=b;W.addHoverDom(c,b)},onHoverOutNode:function(a,b){var c=P.getSetting(a.data.treeId),d=P.getRoot(c);if(d.curHoverNode&&!P.isSelectedNode(c,d.curHoverNode)){W.removeTreeDom(c,d.curHoverNode);d.curHoverNode=null}},onMousedownNode:function(h,p){var ag,c,i=P.getSetting(h.data.treeId),d=P.getRoot(i),o=P.getRoots();if(h.button==2||!i.edit.enable||(!i.edit.drag.isCopy&&!i.edit.drag.isMove)){return true}var A=h.target,q=P.getRoot(i).curSelectedList,g=[];if(!P.isSelectedNode(i,p)){g=[p]}else{for(ag=0,c=q.length;ag<c;ag++){if(q[ag].editNameFlag&&H.eqs(A.tagName,"input")&&A.getAttribute("treeNode"+O.id.INPUT)!==null){return true}g.push(q[ag]);if(g[0].parentTId!==q[ag].parentTId){g=[p];break}}}W.editNodeBlur=true;W.cancelCurEditNode(i);var x=aa(i.treeObj.get(0).ownerDocument),n=aa(i.treeObj.get(0).ownerDocument.body),a,m,C,B=false,z=i,r=i,w,s,f=null,t=null,j=null,v=O.move.TYPE_INNER,b=h.clientX,e=h.clientY,l=(new Date()).getTime();if(H.uCanDo(i)){x.bind("mousemove",k)}function k(bR){if(d.dragFlag==0&&Math.abs(b-bR.clientX)<i.edit.drag.minMoveSize&&Math.abs(e-bR.clientY)<i.edit.drag.minMoveSize){return true}var bX,bt,a9,by,bG,bz=i.data.key.children;n.css("cursor","pointer");if(d.dragFlag==0){if(H.apply(i.callback.beforeDrag,[i.treeId,g],true)==false){y(bR);return true}for(bX=0,bt=g.length;bX<bt;bX++){if(bX==0){d.dragNodeShowBefore=[]}a9=g[bX];if(a9.isParent&&a9.open){W.expandCollapseNode(i,a9,!a9.open);d.dragNodeShowBefore[a9.tId]=true}else{d.dragNodeShowBefore[a9.tId]=false}}d.dragFlag=1;o.showHoverDom=false;H.showIfameMask(i,true);var bo=true,bl=-1;if(g.length>1){var bb=g[0].parentTId?g[0].getParentNode()[bz]:P.getNodes(i);bG=[];for(bX=0,bt=bb.length;bX<bt;bX++){if(d.dragNodeShowBefore[bb[bX].tId]!==undefined){if(bo&&bl>-1&&(bl+1)!==bX){bo=false}bG.push(bb[bX]);bl=bX}if(g.length===bG.length){g=bG;break}}}if(bo){w=g[0].getPreNode();s=g[g.length-1].getNextNode()}a=X("<ul class='zTreeDragUL'></ul>",i);for(bX=0,bt=g.length;bX<bt;bX++){a9=g[bX];a9.editNameFlag=false;W.selectNode(i,a9,bX>0);W.removeTreeDom(i,a9);if(bX>i.edit.drag.maxShowNodeNum-1){continue}by=X("<li id='"+a9.tId+"_tmp'></li>",i);by.append(X(a9,O.id.A,i).clone());by.css("padding","0");by.children("#"+a9.tId+O.id.A).removeClass(O.node.CURSELECTED);a.append(by);if(bX==i.edit.drag.maxShowNodeNum-1){by=X("<li id='"+a9.tId+"_moretmp'><a>  ...  </a></li>",i);a.append(by)}}a.attr("id",g[0].tId+O.id.UL+"_tmp");a.addClass(i.treeObj.attr("class"));a.appendTo(n);m=X("<span class='tmpzTreeMove_arrow'></span>",i);m.attr("id","zTreeMove_arrow_tmp");m.appendTo(n);i.treeObj.trigger(O.event.DRAG,[bR,i.treeId,g])}if(d.dragFlag==1){if(C&&m.attr("id")==bR.target.id&&j&&(bR.clientX+x.scrollLeft()+2)>(aa("#"+j+O.id.A,C).offset().left)){var bS=aa("#"+j+O.id.A,C);bR.target=(bS.length>0)?bS.get(0):bR.target}else{if(C){C.removeClass(O.node.TMPTARGET_TREE);if(j){aa("#"+j+O.id.A,C).removeClass(O.node.TMPTARGET_NODE+"_"+O.move.TYPE_PREV).removeClass(O.node.TMPTARGET_NODE+"_"+M.move.TYPE_NEXT).removeClass(O.node.TMPTARGET_NODE+"_"+M.move.TYPE_INNER)}}}C=null;j=null;B=false;z=i;var bW=P.getSettings();for(var bx in bW){if(bW[bx].treeId&&bW[bx].edit.enable&&bW[bx].treeId!=i.treeId&&(bR.target.id==bW[bx].treeId||aa(bR.target).parents("#"+bW[bx].treeId).length>0)){B=true;z=bW[bx]}}var bc=x.scrollTop(),bT=x.scrollLeft(),bn=z.treeObj.offset(),bM=z.treeObj.get(0).scrollHeight,bw=z.treeObj.get(0).scrollWidth,bV=(bR.clientY+bc-bn.top),bA=(z.treeObj.height()+bn.top-bR.clientY-bc),bF=(bR.clientX+bT-bn.left),bd=(z.treeObj.width()+bn.left-bR.clientX-bT),ba=(bV<i.edit.drag.borderMax&&bV>i.edit.drag.borderMin),bQ=(bA<i.edit.drag.borderMax&&bA>i.edit.drag.borderMin),bC=(bF<i.edit.drag.borderMax&&bF>i.edit.drag.borderMin),bf=(bd<i.edit.drag.borderMax&&bd>i.edit.drag.borderMin),bm=bV>i.edit.drag.borderMin&&bA>i.edit.drag.borderMin&&bF>i.edit.drag.borderMin&&bd>i.edit.drag.borderMin,bI=(ba&&z.treeObj.scrollTop()<=0),bJ=(bQ&&(z.treeObj.scrollTop()+z.treeObj.height()+10)>=bM),bj=(bC&&z.treeObj.scrollLeft()<=0),bO=(bf&&(z.treeObj.scrollLeft()+z.treeObj.width()+10)>=bw);if(bR.target&&H.isChildOrSelf(bR.target,z.treeId)){var be=bR.target;while(be&&be.tagName&&!H.eqs(be.tagName,"li")&&be.id!=z.treeId){be=be.parentNode}var bP=true;for(bX=0,bt=g.length;bX<bt;bX++){a9=g[bX];if(be.id===a9.tId){bP=false;break}else{if(X(a9,i).find("#"+be.id).length>0){bP=false;break}}}if(bP&&bR.target&&H.isChildOrSelf(bR.target,be.id+O.id.A)){C=aa(be);j=be.id}}a9=g[0];if(bm&&H.isChildOrSelf(bR.target,z.treeId)){if(!C&&(bR.target.id==z.treeId||bI||bJ||bj||bO)&&(B||(!B&&a9.parentTId))){C=z.treeObj}if(ba){z.treeObj.scrollTop(z.treeObj.scrollTop()-10)}else{if(bQ){z.treeObj.scrollTop(z.treeObj.scrollTop()+10)}}if(bC){z.treeObj.scrollLeft(z.treeObj.scrollLeft()-10)}else{if(bf){z.treeObj.scrollLeft(z.treeObj.scrollLeft()+10)}}if(C&&C!=z.treeObj&&C.offset().left<z.treeObj.offset().left){z.treeObj.scrollLeft(z.treeObj.scrollLeft()+C.offset().left-z.treeObj.offset().left)}}a.css({top:(bR.clientY+bc+3)+"px",left:(bR.clientX+bT+3)+"px"});var bK=0;var bL=0;if(C&&C.attr("id")!=z.treeId){var bB=j==null?null:P.getNodeCache(z,j),bH=((bR.ctrlKey||bR.metaKey)&&i.edit.drag.isMove&&i.edit.drag.isCopy)||(!i.edit.drag.isMove&&i.edit.drag.isCopy),bh=!!(w&&j===w.tId),bD=!!(s&&j===s.tId),br=(a9.parentTId&&a9.parentTId==j),bE=(bH||!bD)&&H.apply(z.edit.drag.prev,[z.treeId,g,bB],!!z.edit.drag.prev),bi=(bH||!bh)&&H.apply(z.edit.drag.next,[z.treeId,g,bB],!!z.edit.drag.next),bp=(bH||!br)&&!(z.data.keep.leaf&&!bB.isParent)&&H.apply(z.edit.drag.inner,[z.treeId,g,bB],!!z.edit.drag.inner);function bU(){C=null;j="";v=O.move.TYPE_INNER;m.css({display:"none"});if(window.zTreeMoveTimer){clearTimeout(window.zTreeMoveTimer);window.zTreeMoveTargetNodeTId=null}}if(!bE&&!bi&&!bp){bU()}else{var bN=aa("#"+j+O.id.A,C),bu=bB.isLastNode?null:aa("#"+bB.getNextNode().tId+O.id.A,C.next()),bs=bN.offset().top,bq=bN.offset().left,bv=bE?(bp?0.25:(bi?0.5:1)):-1,bg=bi?(bp?0.75:(bE?0.5:0)):-1,bk=(bR.clientY+bc-bs)/bN.height();if((bv==1||bk<=bv&&bk>=-0.2)&&bE){bK=1-m.width();bL=bs-m.height()/2;v=O.move.TYPE_PREV}else{if((bg==0||bk>=bg&&bk<=1.2)&&bi){bK=1-m.width();bL=(bu==null||(bB.isParent&&bB.open))?(bs+bN.height()-m.height()/2):(bu.offset().top-m.height()/2);v=O.move.TYPE_NEXT}else{if(bp){bK=5-m.width();bL=bs;v=O.move.TYPE_INNER}else{bU()}}}if(C){m.css({display:"block",top:bL+"px",left:(bq+bK)+"px"});bN.addClass(O.node.TMPTARGET_NODE+"_"+v);if(f!=j||t!=v){l=(new Date()).getTime()}if(bB&&bB.isParent&&v==O.move.TYPE_INNER){var a8=true;if(window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==bB.tId){clearTimeout(window.zTreeMoveTimer);window.zTreeMoveTargetNodeTId=null}else{if(window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===bB.tId){a8=false}}if(a8){window.zTreeMoveTimer=setTimeout(function(){if(v!=O.move.TYPE_INNER){return}if(bB&&bB.isParent&&!bB.open&&(new Date()).getTime()-l>z.edit.drag.autoOpenTime&&H.apply(z.callback.beforeDragOpen,[z.treeId,bB],true)){W.switchNode(z,bB);if(z.edit.drag.autoExpandTrigger){z.treeObj.trigger(O.event.EXPAND,[z.treeId,bB])}}},z.edit.drag.autoOpenTime+50);window.zTreeMoveTargetNodeTId=bB.tId}}}}}else{v=O.move.TYPE_INNER;if(C&&H.apply(z.edit.drag.inner,[z.treeId,g,null],!!z.edit.drag.inner)){C.addClass(O.node.TMPTARGET_TREE)}else{C=null}m.css({display:"none"});if(window.zTreeMoveTimer){clearTimeout(window.zTreeMoveTimer);window.zTreeMoveTargetNodeTId=null}}f=j;t=v;i.treeObj.trigger(O.event.DRAGMOVE,[bR,i.treeId,g])}return false}x.bind("mouseup",y);function y(ar){if(window.zTreeMoveTimer){clearTimeout(window.zTreeMoveTimer);window.zTreeMoveTargetNodeTId=null}f=null;t=null;x.unbind("mousemove",k);x.unbind("mouseup",y);x.unbind("selectstart",u);n.css("cursor","auto");if(C){C.removeClass(O.node.TMPTARGET_TREE);if(j){aa("#"+j+O.id.A,C).removeClass(O.node.TMPTARGET_NODE+"_"+O.move.TYPE_PREV).removeClass(O.node.TMPTARGET_NODE+"_"+M.move.TYPE_NEXT).removeClass(O.node.TMPTARGET_NODE+"_"+M.move.TYPE_INNER)}}H.showIfameMask(i,false);o.showHoverDom=true;if(d.dragFlag==0){return}d.dragFlag=0;var au,ap,at;for(au=0,ap=g.length;au<ap;au++){at=g[au];if(at.isParent&&d.dragNodeShowBefore[at.tId]&&!at.open){W.expandCollapseNode(i,at,!at.open);delete d.dragNodeShowBefore[at.tId]}}if(a){a.remove()}if(m){m.remove()}var aq=((ar.ctrlKey||ar.metaKey)&&i.edit.drag.isMove&&i.edit.drag.isCopy)||(!i.edit.drag.isMove&&i.edit.drag.isCopy);if(!aq&&C&&j&&g[0].parentTId&&j==g[0].parentTId&&v==O.move.TYPE_INNER){C=null}if(C){var ax=j==null?null:P.getNodeCache(z,j);if(H.apply(i.callback.beforeDrop,[z.treeId,g,ax,v,aq],true)==false){W.selectNodes(r,g);return}var aw=aq?H.clone(g):g;function av(){if(B){if(!aq){for(var ai=0,aj=g.length;ai<aj;ai++){W.removeNode(i,g[ai])}}if(v==O.move.TYPE_INNER){W.addNodes(z,ax,-1,aw)}else{W.addNodes(z,ax.getParentNode(),v==O.move.TYPE_PREV?ax.getIndex():ax.getIndex()+1,aw)}}else{if(aq&&v==O.move.TYPE_INNER){W.addNodes(z,ax,-1,aw)}else{if(aq){W.addNodes(z,ax.getParentNode(),v==O.move.TYPE_PREV?ax.getIndex():ax.getIndex()+1,aw)}else{if(v!=O.move.TYPE_NEXT){for(ai=0,aj=aw.length;ai<aj;ai++){W.moveNode(z,ax,aw[ai],v,false)}}else{for(ai=-1,aj=aw.length-1;ai<aj;aj--){W.moveNode(z,ax,aw[aj],v,false)}}}}}W.selectNodes(z,aw);var ak=X(aw[0],i).get(0);if(ak){if(ak.scrollIntoView){ak.scrollIntoView(false)}else{try{ak.focus().blur()}catch(ah){}}}i.treeObj.trigger(O.event.DROP,[ar,z.treeId,aw,ax,v,aq])}if(v==O.move.TYPE_INNER&&H.canAsync(z,ax)){W.asyncNode(z,ax,false,av)}else{av()}}else{W.selectNodes(r,g);i.treeObj.trigger(O.event.DROP,[ar,i.treeId,g,null,null,null])}}x.bind("selectstart",u);function u(){return false}if(h.preventDefault){h.preventDefault()}return true}},Y={getAbs:function(c){var a=c.getBoundingClientRect(),d=document.body.scrollTop+document.documentElement.scrollTop,b=document.body.scrollLeft+document.documentElement.scrollLeft;return[a.left+b,a.top+d]},inputFocus:function(a){if(a.get(0)){a.focus();H.setCursorPosition(a.get(0),a.val().length)}},inputSelect:function(a){if(a.get(0)){a.focus();a.select()}},setCursorPosition:function(b,a){if(b.setSelectionRange){b.focus();b.setSelectionRange(a,a)}else{if(b.createTextRange){var c=b.createTextRange();c.collapse(true);c.moveEnd("character",a);c.moveStart("character",a);c.select()}}},showIfameMask:function(c,e){var f=P.getRoot(c);while(f.dragMaskList.length>0){f.dragMaskList[0].remove();f.dragMaskList.shift()}if(e){var b=X("iframe",c);for(var g=0,i=b.length;g<i;g++){var h=b.get(g),a=H.getAbs(h),d=X("<div id='zTreeMask_"+g+"' class='zTreeMask' style='top:"+a[1]+"px; left:"+a[0]+"px; width:"+h.offsetWidth+"px; height:"+h.offsetHeight+"px;'></div>",c);d.appendTo(X("body",c));f.dragMaskList.push(d)}}}},ac={addEditBtn:function(c,b){if(b.editNameFlag||X(b,O.id.EDIT,c).length>0){return}if(!H.apply(c.edit.showRenameBtn,[c.treeId,b],c.edit.showRenameBtn)){return}var a=X(b,O.id.A,c),d="<span class='"+O.className.BUTTON+" edit' id='"+b.tId+O.id.EDIT+"' title='"+H.apply(c.edit.renameTitle,[c.treeId,b],c.edit.renameTitle)+"' treeNode"+O.id.EDIT+" style='display:none;'></span>";a.append(d);X(b,O.id.EDIT,c).bind("click",function(){if(!H.uCanDo(c)||H.apply(c.callback.beforeEditName,[c.treeId,b],true)==false){return false}W.editNode(c,b);return false}).show()},addRemoveBtn:function(d,c){if(c.editNameFlag||X(c,O.id.REMOVE,d).length>0){return}if(!H.apply(d.edit.showRemoveBtn,[d.treeId,c],d.edit.showRemoveBtn)){return}var a=X(c,O.id.A,d),b="<span class='"+O.className.BUTTON+" remove' id='"+c.tId+O.id.REMOVE+"' title='"+H.apply(d.edit.removeTitle,[d.treeId,c],d.edit.removeTitle)+"' treeNode"+O.id.REMOVE+" style='display:none;'></span>";a.append(b);X(c,O.id.REMOVE,d).bind("click",function(){if(!H.uCanDo(d)||H.apply(d.callback.beforeRemove,[d.treeId,c],true)==false){return false}W.removeNode(d,c);d.treeObj.trigger(O.event.REMOVE,[d.treeId,c]);return false}).bind("mousedown",function(e){return true}).show()},addHoverDom:function(b,a){if(P.getRoots().showHoverDom){a.isHover=true;if(b.edit.enable){W.addEditBtn(b,a);W.addRemoveBtn(b,a)}H.apply(b.view.addHoverDom,[b.treeId,a])}},cancelCurEditNode:function(c,b,f){var d=P.getRoot(c),g=c.data.key.name,i=d.curEditNode;if(i){var h=d.curEditInput,e=b?b:(f?i[g]:h.val());if(H.apply(c.callback.beforeRename,[c.treeId,i,e,f],true)===false){return false}i[g]=e;var a=X(i,O.id.A,c);a.removeClass(O.node.CURSELECTED_EDIT);h.unbind();W.setNodeName(c,i);i.editNameFlag=false;d.curEditNode=null;d.curEditInput=null;W.selectNode(c,i,false);c.treeObj.trigger(O.event.RENAME,[c.treeId,i,f])}d.noSelection=true;return true},editNode:function(b,a){var e=P.getRoot(b);W.editNodeBlur=false;if(P.isSelectedNode(b,a)&&e.curEditNode==a&&a.editNameFlag){setTimeout(function(){H.inputFocus(e.curEditInput)},0);return}var c=b.data.key.name;a.editNameFlag=true;W.removeTreeDom(b,a);W.cancelCurEditNode(b);W.selectNode(b,a,false);X(a,O.id.SPAN,b).html("<input type=text class='rename' id='"+a.tId+O.id.INPUT+"' treeNode"+O.id.INPUT+" >");var d=X(a,O.id.INPUT,b);d.attr("value",a[c]);if(b.edit.editNameSelectAll){H.inputSelect(d)}else{H.inputFocus(d)}d.bind("blur",function(f){if(!W.editNodeBlur){W.cancelCurEditNode(b)}}).bind("keydown",function(f){if(f.keyCode=="13"){W.editNodeBlur=true;W.cancelCurEditNode(b)}else{if(f.keyCode=="27"){W.cancelCurEditNode(b,null,true)}}}).bind("click",function(f){return false}).bind("dblclick",function(f){return false});X(a,O.id.A,b).addClass(O.node.CURSELECTED_EDIT);e.curEditInput=d;e.noSelection=false;e.curEditNode=a},moveNode:function(m,t,j,u,x,s){var h=P.getRoot(m),o=m.data.key.children;if(t==j){return}if(m.data.keep.leaf&&t&&!t.isParent&&u==O.move.TYPE_INNER){return}var e=(j.parentTId?j.getParentNode():h),k=(t===null||t==h);if(k&&t===null){t=h}if(k){u=O.move.TYPE_INNER}var w=(t.parentTId?t.getParentNode():h);if(u!=O.move.TYPE_PREV&&u!=O.move.TYPE_NEXT){u=O.move.TYPE_INNER}if(u==O.move.TYPE_INNER){if(k){j.parentTId=null}else{if(!t.isParent){t.isParent=true;t.open=!!t.open;W.setNodeLineIcos(m,t)}j.parentTId=t.tId}}var r,p;if(k){r=m.treeObj;p=r}else{if(!s&&u==O.move.TYPE_INNER){W.expandCollapseNode(m,t,true,false)}else{if(!s){W.expandCollapseNode(m,t.getParentNode(),true,false)}}r=X(t,m);p=X(t,O.id.UL,m);if(!!r.get(0)&&!p.get(0)){var a=[];W.makeUlHtml(m,t,a,"");r.append(a.join(""))}p=X(t,O.id.UL,m)}var c=X(j,m);if(!c.get(0)){c=W.appendNodes(m,j.level,[j],null,-1,false,true).join("")}else{if(!r.get(0)){c.remove()}}if(p.get(0)&&u==O.move.TYPE_INNER){p.append(c)}else{if(r.get(0)&&u==O.move.TYPE_PREV){r.before(c)}else{if(r.get(0)&&u==O.move.TYPE_NEXT){r.after(c)}}}var f,g,q=-1,d=0,y=null,v=null,b=j.level;if(j.isFirstNode){q=0;if(e[o].length>1){y=e[o][1];y.isFirstNode=true}}else{if(j.isLastNode){q=e[o].length-1;y=e[o][q-1];y.isLastNode=true}else{for(f=0,g=e[o].length;f<g;f++){if(e[o][f].tId==j.tId){q=f;break}}}}if(q>=0){e[o].splice(q,1)}if(u!=O.move.TYPE_INNER){for(f=0,g=w[o].length;f<g;f++){if(w[o][f].tId==t.tId){d=f}}}if(u==O.move.TYPE_INNER){if(!t[o]){t[o]=new Array()}if(t[o].length>0){v=t[o][t[o].length-1];v.isLastNode=false}t[o].splice(t[o].length,0,j);j.isLastNode=true;j.isFirstNode=(t[o].length==1)}else{if(t.isFirstNode&&u==O.move.TYPE_PREV){w[o].splice(d,0,j);v=t;v.isFirstNode=false;j.parentTId=t.parentTId;j.isFirstNode=true;j.isLastNode=false}else{if(t.isLastNode&&u==O.move.TYPE_NEXT){w[o].splice(d+1,0,j);v=t;v.isLastNode=false;j.parentTId=t.parentTId;j.isFirstNode=false;j.isLastNode=true}else{if(u==O.move.TYPE_PREV){w[o].splice(d,0,j)}else{w[o].splice(d+1,0,j)}j.parentTId=t.parentTId;j.isFirstNode=false;j.isLastNode=false}}}P.fixPIdKeyValue(m,j);P.setSonNodeLevel(m,j.getParentNode(),j);W.setNodeLineIcos(m,j);W.repairNodeLevelClass(m,j,b);if(!m.data.keep.parent&&e[o].length<1){e.isParent=false;e.open=false;var l=X(e,O.id.UL,m),i=X(e,O.id.SWITCH,m),n=X(e,O.id.ICON,m);W.replaceSwitchClass(e,i,O.folder.DOCU);W.replaceIcoClass(e,n,O.folder.DOCU);l.css("display","none")}else{if(y){W.setNodeLineIcos(m,y)}}if(v){W.setNodeLineIcos(m,v)}if(!!m.check&&m.check.enable&&W.repairChkClass){W.repairChkClass(m,e);W.repairParentChkClassWithSelf(m,e);if(e!=j.parent){W.repairParentChkClassWithSelf(m,j)}}if(!s){W.expandCollapseParentNode(m,j.getParentNode(),true,x)}},removeEditBtn:function(b,a){X(a,O.id.EDIT,b).unbind().remove()},removeRemoveBtn:function(b,a){X(a,O.id.REMOVE,b).unbind().remove()},removeTreeDom:function(b,a){a.isHover=false;W.removeEditBtn(b,a);W.removeRemoveBtn(b,a);H.apply(b.view.removeHoverDom,[b.treeId,a])},repairNodeLevelClass:function(g,e,f){if(f===e.level){return}var d=X(e,g),a=X(e,O.id.A,g),b=X(e,O.id.UL,g),h=O.className.LEVEL+f,c=O.className.LEVEL+e.level;d.removeClass(h);d.addClass(c);a.removeClass(h);a.addClass(c);b.removeClass(h);b.addClass(c)},selectNodes:function(a,c){for(var b=0,d=c.length;b<d;b++){W.selectNode(a,c[b],b>0)}}},J={tools:Y,view:ac,event:Z,data:Q};aa.extend(true,aa.fn.zTree.consts,M);aa.extend(true,aa.fn.zTree._z,J);var ae=aa.fn.zTree,H=ae._z.tools,O=ae.consts,W=ae._z.view,P=ae._z.data,K=ae._z.event,X=H.$;P.exSetting(T);P.addInitBind(S);P.addInitUnBind(D);P.addInitCache(ad);P.addInitNode(G);P.addInitProxy(R);P.addInitRoot(F);P.addZTreeTools(V);var I=W.cancelPreSelectedNode;W.cancelPreSelectedNode=function(c,b){var a=P.getRoot(c).curSelectedList;for(var d=0,e=a.length;d<e;d++){if(!b||b===a[d]){W.removeTreeDom(c,a[d]);if(b){break}}}if(I){I.apply(W,arguments)}};var E=W.createNodes;W.createNodes=function(b,a,d,e,c){if(E){E.apply(W,arguments)}if(!d){return}if(W.repairParentChkClassWithSelf){W.repairParentChkClassWithSelf(b,e)}};var L=W.makeNodeUrl;W.makeNodeUrl=function(b,a){return b.edit.enable?null:(L.apply(W,arguments))};var af=W.removeNode;W.removeNode=function(b,a){var c=P.getRoot(b);if(c.curEditNode===a){c.curEditNode=null}if(af){af.apply(W,arguments)}};var N=W.selectNode;W.selectNode=function(b,a,c){var d=P.getRoot(b);if(P.isSelectedNode(b,a)&&d.curEditNode==a&&a.editNameFlag){return false}if(N){N.apply(W,arguments)}W.addHoverDom(b,a);return true};var ab=H.uCanDo;H.uCanDo=function(b,a){var c=P.getRoot(b);if(a&&(H.eqs(a.type,"mouseover")||H.eqs(a.type,"mouseout")||H.eqs(a.type,"mousedown")||H.eqs(a.type,"mouseup"))){return true}if(c.curEditNode){W.editNodeBlur=false;c.curEditInput.focus()}return(!c.curEditNode)&&(ab?ab.apply(W,arguments):true)}})(jQuery);