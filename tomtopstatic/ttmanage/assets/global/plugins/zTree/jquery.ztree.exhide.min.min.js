(function(L){var x=function(b,g,a,d,e,c,f){if(typeof a.isHidden=="string"){a.isHidden=y.eqs(a.isHidden,"true")}a.isHidden=!!a.isHidden;w.initHideForExCheck(b,a)},P=function(b,a,c){},H=function(a,b){b.showNodes=function(e,d){I.showNodes(a,e,d)};b.showNode=function(d,e){if(!d){return}I.showNodes(a,[d],e)};b.hideNodes=function(e,d){I.hideNodes(a,e,d)};b.hideNode=function(d,e){if(!d){return}I.hideNodes(a,[d],e)};var c=b.checkNode;if(c){b.checkNode=function(d,e,g,f){if(!!d&&!!d.isHidden){return}c.apply(b,arguments)}}},F={initHideForExCheck:function(b,a){if(a.isHidden&&b.check&&b.check.enable){if(typeof a._nocheck=="undefined"){a._nocheck=!!a.nocheck;a.nocheck=true}a.check_Child_State=-1;if(I.repairParentChkClassWithSelf){I.repairParentChkClassWithSelf(b,a)}}},initShowForExCheck:function(b,a){if(!a.isHidden&&b.check&&b.check.enable){if(typeof a._nocheck!="undefined"){a.nocheck=a._nocheck;delete a._nocheck}if(I.setChkClass){var c=J(a,E.id.CHECK,b);I.setChkClass(b,c,a)}if(I.repairParentChkClassWithSelf){I.repairParentChkClassWithSelf(b,a)}}}},N={clearOldFirstNode:function(c,b){var a=b.getNextNode();while(!!a){if(a.isFirstNode){a.isFirstNode=false;I.setNodeLineIcos(c,a);break}if(a.isLastNode){break}a=a.getNextNode()}},clearOldLastNode:function(c,b,a){var d=b.getPreNode();while(!!d){if(d.isLastNode){d.isLastNode=false;if(a){I.setNodeLineIcos(c,d)}break}if(d.isFirstNode){break}d=d.getPreNode()}},makeDOMNodeMainBefore:function(c,b,a){c.push("<li ",(a.isHidden?"style='display:none;' ":""),"id='",a.tId,"' class='",E.className.LEVEL,a.level,"' tabindex='0' hidefocus='true' treenode>")},showNode:function(b,a,c){a.isHidden=false;w.initShowForExCheck(b,a);J(a,b).show()},showNodes:function(a,i,j){if(!i||i.length==0){return}var f={},c,d;for(c=0,d=i.length;c<d;c++){var g=i[c];if(!f[g.parentTId]){var e=g.getParentNode();f[g.parentTId]=(e===null)?w.getRoot(a):g.getParentNode()}I.showNode(a,g,j)}for(var b in f){var h=f[b][a.data.key.children];I.setFirstNodeForShow(a,h);I.setLastNodeForShow(a,h)}},hideNode:function(b,a,c){a.isHidden=true;a.isFirstNode=false;a.isLastNode=false;w.initHideForExCheck(b,a);I.cancelPreSelectedNode(b,a);J(a,b).hide()},hideNodes:function(a,i,j){if(!i||i.length==0){return}var f={},c,d;for(c=0,d=i.length;c<d;c++){var g=i[c];if((g.isFirstNode||g.isLastNode)&&!f[g.parentTId]){var e=g.getParentNode();f[g.parentTId]=(e===null)?w.getRoot(a):g.getParentNode()}I.hideNode(a,g,j)}for(var b in f){var h=f[b][a.data.key.children];I.setFirstNodeForHide(a,h);I.setLastNodeForHide(a,h)}},setFirstNode:function(b,c){var d=b.data.key.children,a=c[d].length;if(a>0&&!c[d][0].isHidden){c[d][0].isFirstNode=true}else{if(a>0){I.setFirstNodeForHide(b,c[d])}}},setLastNode:function(b,c){var d=b.data.key.children,a=c[d].length;if(a>0&&!c[d][0].isHidden){c[d][a-1].isLastNode=true}else{if(a>0){I.setLastNodeForHide(b,c[d])}}},setFirstNodeForHide:function(e,c){var d,a,b;for(a=0,b=c.length;a<b;a++){d=c[a];if(d.isFirstNode){break}if(!d.isHidden&&!d.isFirstNode){d.isFirstNode=true;I.setNodeLineIcos(e,d);break}else{d=null}}return d},setFirstNodeForShow:function(e,c){var g,f,b,a,d;for(f=0,b=c.length;f<b;f++){g=c[f];if(!a&&!g.isHidden&&g.isFirstNode){a=g;break}else{if(!a&&!g.isHidden&&!g.isFirstNode){g.isFirstNode=true;a=g;I.setNodeLineIcos(e,g)}else{if(a&&g.isFirstNode){g.isFirstNode=false;d=g;I.setNodeLineIcos(e,g);break}else{g=null}}}}return{"new":a,old:d}},setLastNodeForHide:function(a,c){var d,b;for(b=c.length-1;b>=0;b--){d=c[b];if(d.isLastNode){break}if(!d.isHidden&&!d.isLastNode){d.isLastNode=true;I.setNodeLineIcos(a,d);break}else{d=null}}return d},setLastNodeForShow:function(e,c){var g,f,b,a,d;for(f=c.length-1;f>=0;f--){g=c[f];if(!a&&!g.isHidden&&g.isLastNode){a=g;break}else{if(!a&&!g.isHidden&&!g.isLastNode){g.isLastNode=true;a=g;I.setNodeLineIcos(e,g)}else{if(a&&g.isLastNode){g.isLastNode=false;d=g;I.setNodeLineIcos(e,g);break}else{g=null}}}}return{"new":a,old:d}}},B={view:N,data:F};L.extend(true,L.fn.zTree._z,B);var O=L.fn.zTree,y=O._z.tools,E=O.consts,I=O._z.view,w=O._z.data,A=O._z.event,J=y.$;w.addInitNode(x);w.addBeforeA(P);w.addZTreeTools(H);var M=w.initNode;w.initNode=function(a,i,e,d,b,c,g){var f=(d)?d:w.getRoot(a),h=f[a.data.key.children];w.tmpHideFirstNode=I.setFirstNodeForHide(a,h);w.tmpHideLastNode=I.setLastNodeForHide(a,h);if(g){I.setNodeLineIcos(a,w.tmpHideFirstNode);I.setNodeLineIcos(a,w.tmpHideLastNode)}b=(w.tmpHideFirstNode===e);c=(w.tmpHideLastNode===e);if(M){M.apply(w,arguments)}if(g&&c){I.clearOldLastNode(a,e,g)}};var z=w.makeChkFlag;if(!!z){w.makeChkFlag=function(b,a){if(!!a&&!!a.isHidden){return}z.apply(w,arguments)}}var K=w.getTreeCheckedNodes;if(!!K){w.getTreeCheckedNodes=function(a,c,e,b){if(!!c&&c.length>0){var d=c[0].getParentNode();if(!!d&&!!d.isHidden){return[]}}return K.apply(w,arguments)}}var D=w.getTreeChangeCheckedNodes;if(!!D){w.getTreeChangeCheckedNodes=function(a,c,b){if(!!c&&c.length>0){var d=c[0].getParentNode();if(!!d&&!!d.isHidden){return[]}}return D.apply(w,arguments)}}var C=I.expandCollapseSonNode;if(!!C){I.expandCollapseSonNode=function(c,b,e,a,d){if(!!b&&!!b.isHidden){return}C.apply(I,arguments)}}var v=I.setSonNodeCheckBox;if(!!v){I.setSonNodeCheckBox=function(c,b,a,d){if(!!b&&!!b.isHidden){return}v.apply(I,arguments)}}var G=I.repairParentChkClassWithSelf;if(!!G){I.repairParentChkClassWithSelf=function(b,a){if(!!a&&!!a.isHidden){return}G.apply(I,arguments)}}})(jQuery);