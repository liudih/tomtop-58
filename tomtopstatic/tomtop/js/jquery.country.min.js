
/**
 * 国家插件
 * demo : $('#id').country();
 * 当某个国家被选中时你需要处理某些逻辑的时候
 *  $('#id').country({selected : function(){
 *  	//yourself code
 *  }});
 * @author lijun
 */(function(a,m,n){function d(b,c){this.element="string"===typeof b?a("#"+b):b;this.options=a.extend({},e,c);this._defaults=e;this._name="country";this.init()}var e={countryIdInputName:"icountry",countryCodeInputName:"countryCode",defaultCountryId:0};d.prototype={init:function(){this.options.id="country_"+Math.floor(1E9*Math.random());this._createElements();this._handleFocusEvent.apply(this);this._handleKeyupEvent.apply(this);this._handleSelectEvent.apply(this)},_createElements:function(){var a=[];a.push('\x3cdiv id\x3d"'+this.options.id+'" class\x3d"newshopping_address_country"\x3e');a.push('\x3cinput tag\x3d"countryCode" type\x3d"text" name\x3d"'+this.options.countryCodeInputName+'" style\x3d"display:none;"/\x3e');a.push('\x3cinput tag\x3d"countryId" type\x3d"text" name\x3d"'+this.options.countryIdInputName+'" style\x3d"display:none;"/\x3e');a.push('\x3cinput tag\x3d"countryName" type\x3d"text" name\x3d"countryName" style\x3d"display:none;"/\x3e');a.push('\x3cdiv class\x3d"address_country"\x3e\x3cdiv tag\x3d"text"\x3e\x3c/div\x3e\x3cspan\x3e\x3ci\x3e\x3c/i\x3e\x3c/span\x3e\x3c/div\x3e');a.push('\x3cdiv class\x3d"country_all" style\x3d"display: none;"\x3e');a.push('\x3cdiv class\x3d"search_country"\x3e\x3cinput type\x3d"text"\x3e\x3c/div\x3e');a.push("\x3c/div\x3e");a.push("\x3c/div\x3e");this.element.before(a.join(""));this.element.appendTo("#"+this.options.id+" .country_all")},getValue:function(){return a("#"+this.options.id).find("input[tag\x3dvalue]").val()},clear:function(){var b=a("#"+this.options.id);b.find("input[name]").each(function(){a(this).val("")});b.find("div[tag\x3dtext]").text("");b.find(".country_all").hide()},destroy:function(){},_handleSelectEvent:function(){var b=a("#"+this.options.id).find("div[tag\x3dtext]"),c=a("#"+this.options.id).find("input[tag\x3dcountryId]"),f=a("#"+this.options.id).find("input[tag\x3dcountryCode]"),d=a("#"+this.options.id).find("input[tag\x3dcountryName]"),e=a("#"+this.options.id).find(".country_all"),h=a("#"+this.options.id).siblings("label");a("#"+this.options.id).find("li").click(function(){var g=a(this).text(),k=a(this).attr("code"),l=a(this).attr("cid");h.hide();b.text(g);d.val(g);f.val(k);c.val(l);e.hide()})},_handleFocusEvent:function(){var b=a("#"+this.options.id),c=a("#"+this.options.id).find(".address_country"),f=a("#"+this.options.id).find(".country_all");c.click(function(){f.show()});b.hover(function(){f.hide()})},_handleBlurEvent:function(){a("#"+this.options.id).hover(function(){},function(){a(this).find("div[tag\x3dselect]").hide()})},_handleKeyupEvent:function(){var b=a("#"+this.options.id).find(".search_country input"),c=a("#"+this.options.id).find(".country_list li");b.keyup(function(){var b=a(this).val(),b=b.toLowerCase();c.each(function(){0!=a(this).text().toLowerCase().indexOf(b)?a(this).hide():a(this).show()})})}};a.country=d;a.countryOptions=[];a.fn.country=function(b){b=new a.country(this.first(),b);a.countryOptions.push(b.options);return b}})(jQuery,document);