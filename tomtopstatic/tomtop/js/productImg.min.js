(function(b){function q(b){for(var e=1;e<arguments.length;e++)b=b.replace("%"+(e-1),arguments[e]);return b}function J(h,e){var c=b("img",h),d,g=null,k=null,f=null,n=null,l=null,z=null,r,E=0,u,v,F=0,G=0,A=0,B=0,H=0,C,D,m=this,I;setTimeout(function(){null===k&&h.width()},200);this.removeBits=function(){f&&(f.remove(),f=null);n&&(n.remove(),n=null);l&&(l.remove(),l=null);null!==z&&(z.remove(),z=null)};this.destroy=function(){h.data("zoom",null);k&&(k.unbind(),k.remove(),k=null);g&&(g.remove(),g=null);this.removeBits()};this.fadedOut=function(){g&&(g.remove(),g=null);this.removeBits()};this.controlLoop=function(){if(f){var b=C-c.offset().left-.5*u>>0,d=D-c.offset().top-.5*v>>0;0>b?b=0:b>c.outerWidth()-u&&(b=c.outerWidth()-u);0>d?d=0:d>c.outerHeight()-v&&(d=c.outerHeight()-v);f.css({left:b,top:d});f.css("background-position",-b+"px "+-d+"px");F=b/c.outerWidth()*r.width>>0;G=d/c.outerHeight()*r.height>>0;B+=(F-B)/e.smoothMove;A+=(G-A)/e.smoothMove;g.css("background-position",-(B>>0)+"px "+(-(A>>0)+"px"))}E=setTimeout(function(){m.controlLoop()},30)};this.init2=function(b,c){H++;1===c&&(r=b);2===H&&this.init()};this.init=function(){k=h.parent().append(q("\x3cdiv class\x3d'mousetrap' style\x3d'background-image:url(\".\");z-index:999;position:absolute;width:100%;height:100%;left:0px;top:0px;'\x3e\x3c/div\x3e",c.outerWidth(),c.outerHeight(),0,0)).find(":last");k.siblings(".mousetrap").remove();k.bind("mousemove",this,function(b){C=b.pageX;D=b.pageY});k.bind("mouseleave",this,function(b){clearTimeout(E);f&&f.fadeOut(299);n&&n.fadeOut(299);l&&l.fadeOut(299);g.fadeOut(300,function(){m.fadedOut()});return!1});k.bind("mouseenter",this,function(d){C=d.pageX;D=d.pageY;I=d.data;g&&(g.stop(!0,!1),g.remove());d=e.adjustX;var m=e.adjustY,t=c.outerWidth(),y=c.outerHeight(),w=e.zoomWidth,x=e.zoomHeight;"auto"==e.zoomWidth&&(w=t);"auto"==e.zoomHeight&&(x=y);var p=h.parent();switch(e.position){case "top":m-=x;break;case "right":d+=t;break;case "bottom":m+=y;break;case "left":d-=w;break;case "inside":w=t;x=y;break;default:p=b("#"+e.position),p.length?(w=p.innerWidth(),x=p.innerHeight()):(p=h,d+=t,m+=y)}t="block"==b("#procuctPOP").css("display")?b("#bigBacks").find("a").attr("href"):1==b(".showCaseWarp").length?b(".hoverBig").find("a").attr("href"):b(this).parents("li.productClass").find(".hoverBig").find("a").attr("href");p.find("#cloud-zoom-big").remove();g=p.append(q('\x3cdiv id\x3d"cloud-zoom-big" class\x3d"cloud-zoom-big" style\x3d"display:none;position:absolute;background-image:url('+t+');z-index:100;background-repeat:no-repeat;"\x3e\x3c/div\x3e',d,m,w,x,r.src)).find(":last");c.attr("title")&&e.showTitle&&g.append(q('\x3cdiv class\x3d"cloud-zoom-title"\x3e%0\x3c/div\x3e',c.attr("title"))).find(":last").css("opacity",e.titleOpacity);g.fadeIn(500);f&&(f.remove(),f=null);u=c.outerWidth()/r.width*g.width();v=c.outerHeight()/r.height*g.height();h.find(".cloud-zoom-lens").remove();f=h.append(q("\x3cdiv class \x3d 'cloud-zoom-lens' style\x3d'display:none;z-index:98;position:absolute;width:%0px;height:%1px;'\x3e\x3c/div\x3e",u,v)).find(":last");k.css("cursor",f.css("cursor"));d=!1;e.tint&&(f.css("background",'url("'+c.attr("src")+'")'),n=h.append(q('\x3cdiv style\x3d"display:none;position:absolute; left:0px; top:0px; width:%0px; height:%1px; background-color:%2;" /\x3e',c.outerWidth(),c.outerHeight(),e.tint)).find(":last"),n.css("opacity",e.tintOpacity),d=!0,n.fadeIn(500));e.softFocus&&(f.css("background",'url("'+c.attr("src")+'")'),l=h.append(q('\x3cdiv style\x3d"position:absolute;display:none;top:2px; left:2px; width:%0px; height:%1px;" /\x3e',c.outerWidth()-2,c.outerHeight()-2,e.tint)).find(":last"),l.css("background",'url("'+c.attr("src")+'")'),l.css("opacity",.5),d=!0,l.fadeIn(500));d||f.css("opacity",e.lensOpacity);"inside"!==e.position&&f.fadeIn(500);I.controlLoop()})};d=new Image;b(d).load(function(){m.init2(this,0)});d.src=c.attr("src");d=new Image;b(d).load(function(){m.init2(this,1)});d.src=h.attr("href")}b(document).ready(function(){b(".cloud-zoom, .cloud-zoom-gallery, .cloud-zoom-click").CloudZoom()});b.fn.CloudZoom=function(h){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}this.each(function(){var e,c;eval("var\ta \x3d {"+b(this).attr("rel")+"}");e=a;b(this).is(".cloud-zoom")?(b(this).css({position:"relative",display:"inline-block"}),b("img",b(this)).css({display:"inline-block"}),"wrap"!=b(this).parent().attr("class")&&(b(this).wrap('\x3cdiv class\x3d"wrap" style\x3d"top:0px;z-index:80;position:relative;text-align:center;width:100%;height:100%"\x3e\x3c/div\x3e'),b(this).parent().append('\x3cspan class\x3d"empty"\x3e\x3c/span\x3e')),c=b.extend({},b.fn.CloudZoom.defaults,h),c=b.extend({},c,e),b(this).data("zoom",new J(b(this),c))):b(this).is(".cloud-zoom-gallery")?(c=b.extend({},e,h),b(this).data("relOpts",c),b(this).bind("mouseover",b(this),function(d){var c=d.data.data("relOpts");b(this).parents("li").siblings().removeClass("cpActive");b(this).parents("li").addClass("cpActive");1==b(".showCaseWarp").length?(b("#"+c.useZoom).attr("href",d.data.attr("href")),b("#"+c.useZoom+" img").attr("src",""),b("#"+c.useZoom+" img").attr("src",d.data.data("relOpts").smallImage),b("#"+d.data.data("relOpts").useZoom).CloudZoom()):(b(this).parents("li.productClass").index(),b(this).parents("li.productClass").find(".cpActive a"),b(this).parents("li.productClass").find("#zoom2").attr("href",d.data.attr("href")),b(this).parents("li.productClass").find(".hoverBig img").attr("src",""),b(this).parents("li.productClass").find(".hoverBig img").attr("src",d.data.data("relOpts").smallImage),b(this).parents("li.productClass").find("#zoom2").CloudZoom());return!1}),b(this).bind("click",b(this),function(b){return!1})):b(this).is(".cloud-zoom-click")&&(c=b.extend({},e,h),b(this).data("relOpts",c),b(this).bind("click",b(this),function(d){var c=d.data.data("relOpts");b(this).parents("li").siblings().removeClass("cpActive");b(this).parents("li").addClass("cpActive");b("#"+c.useZoom).data("zoom").destroy();b("#"+c.useZoom).attr("href",d.data.attr("href"));b("#"+c.useZoom+" img").attr("src","");b("#"+c.useZoom+" img").attr("src",d.data.data("relOpts").smallImage);b("#"+d.data.data("relOpts").useZoom).CloudZoom();return!1}),b(this).bind("click",b(this),function(b){return!1}))});return this};b.fn.CloudZoom.defaults={zoomWidth:"auto",zoomHeight:"auto",position:"right",tint:!1,tintOpacity:.5,lensOpacity:.5,softFocus:!1,smoothMove:3,showTitle:!0,titleOpacity:.5,adjustX:0,adjustY:0}})(jQuery);