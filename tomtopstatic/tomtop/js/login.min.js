reg=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/;var backUrl=$('input[name\x3d"backUrl"]').val(),backUrl=decodeURIComponent(backUrl);function emails(a,b,c){if(""!=a){if(isok=reg.test(a))return c.removeClass("error"),b.html(""),!0;b.html(strFun("TT_language_"+jsLanguage)["tomtop.message.wrongEmail"])}else b.html(strFun("TT_language_"+jsLanguage)["tomtop.message.enterYourEmail"]);c.addClass("error");return!1}function password(a,b,c){6>a.length&&($(".passLen").addClass("error"),c.addClass("error"))}function logPassword(a,b){a.text(strFun("TT_language_"+jsLanguage)["tomtop.message.enterYourPassword"]);b.addClass("error")}function CharMode(a){return 48<=a&&57>=a?1:65<=a&&90>=a?2:97<=a&&122>=a?4:8}function bitTotal(a){for(i=modes=0;4>i;i++)a&1&&modes++,a>>>=1;return modes}function checkStrong(a){if(5>=a.length)return 0;for(i=Modes=0;i<a.length;i++)Modes|=CharMode(a.charCodeAt(i));return bitTotal(Modes)}function passHeight(a){O_color="#efefef";H_color=M_color=L_color="#8ec473";if(null==a||""==a)Lcolor=Mcolor=Hcolor=O_color;else switch(S_level=checkStrong(a),S_level){case 0:Lcolor=Mcolor=Hcolor=O_color;case 1:Lcolor=L_color;Mcolor=Hcolor=O_color;break;case 2:Lcolor=Mcolor=M_color;Hcolor=O_color;break;default:Lcolor=Mcolor=Hcolor=H_color}$(".passLow").css({"background-color":Lcolor});$(".passMedium").css({"background-color":Mcolor});$(".passHigh").css({"background-color":Hcolor})}function passwordAg(a,b,c,d){b!=a&&(c.html("Enter the same password as above!"),d.addClass("error"))}function codes(a,b,c){""==a&&(b.text("captcha is require!"),c.addClass("error"))}function strFun(a){return(new Function("return "+a))()}function getCookie(a){a=document.cookie.match(new RegExp("(^| )"+a+"\x3d([^;]*)(;|$)"));return null!=a?unescape(a[2]):null}var jsLanguage=getCookie("PLAY_LANG")?getCookie("PLAY_LANG"):"en";$(function(){$(".selectLabel").click(function(){$(this).children(".multi-select").toggleClass("multiAci");$(this).removeClass("error");$(this).children(".help-block").text("")});$("#register_email").blur(function(){var a=$(this).val(),b=$(this).next(".help-block"),c=$(this).parents(".controls");emails(a,b,c)});$("#register_password").blur(function(){var a=$(this).val(),b=$(this).next(".help-block"),c=$(this).parents(".controls");passHeight(a);password(a,b,c)});$("#register_password").keyup(function(){var a=$(this).val();passHeight(a)});$("#register_passwordAgain").blur(function(){var a=$(this).val(),b=$("#register_password").val(),c=$(this).next(".help-block"),d=$(this).parents(".controls");passwordAg(a,b,c,d)});$(".codeInput").blur(function(){var a=$(this).val(),b=$(this).siblings(".help-block"),c=$(this).parents(".controls");codes(a,b,c)});$("#register_password,#register_email,#register_passwordAgain,.codeInput").focus(function(){$(this).siblings(".help-block").text("");$(this).parents(".controls").removeClass("error");$("#error").text("")});$("#register_password").focus(function(){$(".passLen").removeClass("error")})});$(function(){$("#changePass").click(function(){var a=$('input[name\x3d"code"]').val(),b=$("#register_password").val(),c=$("#register_passwordAgain").val();6>b.length?($(".passLen").addClass("error"),$(".passLevel").prev(".controls").addClass("error")):b!=c?$("#error").show().text("Enter the same password as above!"):($("#error").hide(),$.ajax({url:"index.php?r\x3dmember/default/changepass",type:"post",dataType:"json",data:{pwd:b,cid:a},success:function(a){1==a.ret?location.href="http://my.tomtop.com/member/login":$("#error").show().text(a.errMsg)}}))})});