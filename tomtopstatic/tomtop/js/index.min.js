//////下拉框公用
$(function(){$("body").click(function(a){$(".btn-group").removeClass("open");a.stopPropagation()});$(".dropdown-toggle").click(function(a){$(this).parent(".btn-group").hasClass("open")?$(this).parent(".btn-group").removeClass("open"):($(".btn-group").removeClass("open"),$(this).parent(".btn-group").addClass("open"));a.stopPropagation()})});$(function(){$(".subSecondA").hover(function(){var a=$(this).index(),c=$(this).parents(".subSecond").siblings(".subThird");$(this).siblings().removeClass("subSecondAci");$(this).addClass("subSecondAci");c.removeClass("thirdBlock");c.eq(a).addClass("thirdBlock")})});$(document).ready(function(){function a(){clearInterval(c);c=setInterval(function(){1>=h.length&&clearInterval(c);next=g+1>=h.length?0:g+1;var a=h.eq(g),b=h.eq(next);a.stop(!0).fadeOut(1E3);b.stop(!0).fadeIn(1E3);$(".bannerPoint b").removeClass("point-on");$(".bannerPoint b").eq(next).addClass("point-on");g=next},5E3)}var c=0,g=0,b=!0,h=$(".imgBanner"),n=$(".bannerwrap"),f=$(".bannerLeft_click"),d=$(".bannerRight_click");a();f.hover(function(){$(this).addClass("leftArrAci")},function(){$(this).removeClass("leftArrAci")});d.hover(function(){$(this).addClass("rightArrAci")},function(){$(this).removeClass("rightArrAci")});$(".bannerPoint b").bind("click",function(){var b=$(this).prevAll("b").length;if(b!=g){clearInterval(c);var d=h.eq(g),f=h.eq(b);d.stop(!0).fadeOut(1E3);f.stop(!0).fadeIn(1E3);$(".bannerPoint b").removeClass("point-on");$(this).addClass("point-on");g=b;a()}});n.mouseover(function(){f.fadeIn();d.fadeIn();clearInterval(c)});n.mouseleave(function(){f.fadeOut();d.fadeOut();a()});f.bind("click",function(){var c=$(".point-on").index();prev=-1>c-1?h.length:c-1;var c=h.eq(g),d=h.eq(prev);b&&(b=!1,c.stop(!0).fadeOut(1E3),d.stop(!0).fadeIn(1E3,function(){b=!0}),$(".bannerPoint b").removeClass("point-on"),$(".bannerPoint b").eq(prev).addClass("point-on"),g=prev,a())});d.bind("click",function(){$(".point-on").index();next=g+1>=h.length?0:g+1;var c=h.eq(g),d=h.eq(next);b&&(b=!1,c.stop(!0).fadeOut(1E3),d.stop(!0).fadeIn(1E3,function(){b=!0}),$(".bannerPoint b").removeClass("point-on"),$(".bannerPoint b").eq(next).addClass("point-on"),g=next,a())})});$(function(){try{moveBox($(".topSellers"))}catch(a){}try{moveBox($(".newArrivals"))}catch(a){}try{moveBox($(".ItemsConsider"))}catch(a){}try{moveBox($(".topBandsWarp"))}catch(a){}});function moveBox(a){function c(a){e.position();a=(a||event).clientX-v;0>a?a=0:a>u.width()-k&&(a=u.width()-k);var b=a/(u.width()-k);f.css({left:-b*(m-d)});e.css({left:a});a=e.position().left;p.html(Math.ceil(a/k)+1)}function g(a){this.onmouseup=this.onmousemove=null;e.removeClass("block");e.releaseCapture&&e.releaseCapture()}var b=1,h=a.find(".moveLeftClick"),n=a.find(".moveRightClick"),f=a.find(".moveBox"),d=a.find(".moveHidden").width(),l=a.find(".moveList"),q=l.outerWidth(!0),m=q*l.length,r=f.position().left,t=Math.ceil(m/d),p=a.siblings().find(".page");a.siblings().find(".pages");var w=a.find(".feed-scrollbar");f.css({width:m});h.addClass("leftArrAci");n.addClass("rightArrAci");m<=d&&(h.hide(),n.hide(),w.hide());n.bind("click",function(){if(!f.is(":animated"))if(0<e.length){if(k>d-(e.position().left+k)&&parseInt(k)!=parseInt(d-e.position().left))e.animate({left:"+\x3d"+(d-e.position().left-k)}),f.animate({left:-(m-r-d)});else if(parseInt(k)==parseInt(d-e.position().left))e.animate({left:0}),f.animate({left:0});else{var a=f.position().left%q,c=f.position().left%(d/l.length);0==a?(e.animate({left:"+\x3d"+k}),f.animate({left:"-\x3d"+d})):(e.animate({left:"+\x3d"+(k+c)}),f.animate({left:"-\x3d"+(d+a)}))}a=e.position().left+1;a=Math.ceil(a/k);a>=t&&parseInt(k)!=parseInt(d-e.position().left)?(a=t,p.html(a)):parseInt(k)==parseInt(d-e.position().left)?p.html(1):p.html(a+1)}else b>=t-1?f.animate({left:-(m-r-d)}).find("img").trigger("sporty"):f.animate({left:"-\x3d"+d}).find("img").trigger("sporty"),b++,b>=t&&(b=t),p.html(b)});h.bind("click",function(){if(!f.is(":animated"))if(0<e.length){if(e.position().left<k&&0!=e.position().left)e.animate({left:0}),f.animate({left:0});else if(0==e.position().left)e.animate({left:d-k}),f.animate({left:-(m-d)});else{var a=q+f.position().left%q,c=d/l.length+f.position().left%(d/l.length);0==a?(e.animate({left:"-\x3d"+k}),f.animate({left:"+\x3d"+d})):(e.animate({left:"-\x3d"+(k-c)}),f.animate({left:"+\x3d"+(d-a)}))}a=e.position().left;a=Math.ceil(a/k);1>=a&&0!=e.position().left?p.html(1):0==e.position().left?p.html(t):p.html(a)}else 2>=b?f.animate({left:0}):f.animate({left:"+\x3d"+d}),b--,1>=b&&(b=1),p.html(b)});var u=a.find(".feed-scrollbar"),e=a.find(".feed-scrollbar-thumb"),k=d/(m/d),v=0;e.css({width:k});e.mousedown(function(a){v=(a||event).clientX-e.position().left;e.addClass("block");e.setCapture?(e.onmousemove=c,e.onmouseup=g,e.setCapture()):(document.onmousemove=c,document.onmouseup=g);return!1})}function moveBanner(a){function c(){$("img.lazy").lazyload({event:"sporty"});clearInterval(g);g=setInterval(function(){b++;b>=f.length&&(b=0);l.animate({left:-d*b}).find("img").trigger("sporty");r.html(b+1)},7E3)}var g=0,b=0,h=a.find(".moveLeftClick"),n=a.find(".moveRightClick"),f=a.find(".moveList"),d=f.outerWidth(!0),l=a.find(".moveBox"),q=a.siblings().find(".pages"),m=f.length,r=a.siblings().find(".page");q.html(m);l.css({width:d*f.length});1>=m&&(h.hide(),n.hide());c();a.hover(function(){clearInterval(g)},function(){c()});n.click(function(){$("img.lazy").lazyload({event:"sporty"});l.is(":animated")||(b++,b>=f.length&&(b=0),l.animate({left:-d*b}).find("img").trigger("sporty"),r.html(b+1))});h.click(function(){$("img.lazy").lazyload({event:"sporty"});l.is(":animated")||(b--,0>b&&(b=f.length-1),l.animate({left:-d*b}).find("img").trigger("sporty"),r.html(b+1))})}$(function(){$("img.lazy").lazyload()});function ischeckemail(){var a=document.getElementById("subEmail").value;""!=a?(isok=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test(a))?window.location.href="http://www.tomtop.com/loyalty/subscribe?email\x3d"+a:Dialog(function(){var a=$(this).parents(".pu_pop");a.fadeOut(function(){a.remove();$("#subEmail").focus()})},strFun("TT_language_"+jsLanguage)["tomtop.common.tip"],strFun("TT_language_"+jsLanguage)["tomtop.message.wrongEmail"]):Dialog(function(){var a=$(this).parents(".pu_pop");a.fadeOut(function(){a.remove();$("#subEmail").focus()})},strFun("TT_language_"+jsLanguage)["tomtop.common.tip"],strFun("TT_language_"+jsLanguage)["tomtop.message.enterYourEmail"])}function Dialog(a,c,g){g={title:c||"",content:g||"",button1:strFun("TT_language_"+jsLanguage)["tomtop.product.cancel"],button2:strFun("TT_language_"+jsLanguage)["tomtop.product.ok"]};g=$.extend({position:{zone:"center"},overlay:!0},g);c="dialogBox_"+Math.floor(1E9*Math.random());g=['\x3cdiv id\x3d"'+c+'"  class\x3d"pu_pop"\x3e','\x3cdiv class\x3d"pu_popWarp"\x3e\x3cp class\x3d"pu_popTitle"\x3e',g.title,'\x3c/p\x3e\x3cdiv class\x3d"pu_popCon"\x3e',g.content,'\x3c/div\x3e\x3cp class\x3d"pu_popBtn"\x3e\x3ca class\x3d"btn cancelC" href\x3d"javascript:;"\x3e',g.button1,'\x3c/a\x3e\x3ca class\x3d"btn btn-primary" tag\x3d"ok" href\x3d"javascript:;"\x3e',g.button2,'\x3c/a\x3e\x3c/p\x3e\x3c/div\x3e\x3cp class\x3d"empty"\x3e \x3c/p\x3e\x3cdiv class\x3d"pu_popBlack"\x3e \x3c/div\x3e\x3c/div\x3e'].join("");$(g).hide().appendTo("body").fadeIn();$.isFunction(a)&&$("#"+c).find("a[tag\x3dok]").click(a);$(".closePop").click(function(){$(".pu_pop").fadeOut(function(){$(this).remove()})});$(".pu_popBlack,.cancelC").click(function(){var a=$(this).parents(".pu_pop");a.fadeOut(function(){a.remove()})})}$(function(){var a=$(".categoriesClass").children("li"),c=$(".categoriesList");a.click(function(){var a=$(this).index(),b=$(this).attr("cat_id"),h=$(".categoriesList").eq(a);h.html();$(this).siblings().removeClass("categoriesAci");$(this).addClass("categoriesAci");0==h.children().length?(0==h.parent().find(".loading-ajax").length&&h.parent().append("\x3cdiv class\x3d'loading-ajax' /\x3e"),$.ajax({type:"GET",cache:!1,url:domain+"index.php?r\x3dsite/ajax",timeout:1E4,data:"cate_id\x3d"+b,dataType:"html",success:function(b){h.html(b);h.find("img").trigger("sporty");h.find(".lazy").lazyload({event:"sporty"});c.hide();c.eq(a).show();$(".loading-ajax").remove()}})):(c.hide(),c.eq(a).show())})});$(function(){if(getCookie("WEB-history")&&1==$("#mightLike").length){var a=function(){$contentLoadTriggered=!0;var a=getCookie("WEB-history").split(",");$.ajax({type:"GET",cache:!1,url:domain+"index.php?r\x3dsite/ajaxyoumightlike\x26position\x3dtop",data:"listing_id\x3d"+a[0],dataType:"html",success:function(a){$("#mightLike").html(a);$(function(){try{moveBox($(".mightLike"))}catch(a){}});$("#mightLike").find("img").trigger("sporty");$("#mightLike").find(".lazy").lazyload({event:"sporty"});$contentLoadTriggered=!0}})};$contentLoadTriggered=!1;$(window).scroll(function(){var c=$("#mightLike").offset().top;c>=$(window).scrollTop()&&c<$(window).scrollTop()+$(window).height()&&0==$contentLoadTriggered&&a()});$("#mightLike").offset().top-$("html,body").scrollTop()<$(window).height()&&0==$contentLoadTriggered&&a()}});$(function(){$(".scrollRightWarp").myScroll({speed:3E3,rowHeight:82})});$(function(){(function(){$.ajax({type:"GET",cache:!1,url:domain+"index.php?r\x3dsite/daily",dataType:"html",success:function(a){$(".dailyDeals").html(a);$("img.lazy").lazyload();moveBanner($(".dealsWarp"));try{var c=$("#serverTime").text();$(".countdown").downCount({date:c+" 23:59:59"})}catch(g){}}})})()});